{% extends 'base.html' %}
{% block content %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>24Hour Recall Method</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='24h.css') }}">
    <script src="{{ url_for('static', filename='24h.js') }}" defer></script>
</head>
<body>
    <h2>24Hour Recall Method</h2>
    <div class="container">
        <div class="24h-main">
            <!-- 1행 : 그룹, 유저 설정 -->
            <div class="person-search">
                <div class="form-group">
                    <label for="userGroup">User Group:</label>
                    <select id="userGroup" name="userGroup" onchange="loadUsers()">
                    </select>
                </div>
                <div class="form-group">
                    <label for="userID">User:</label>
                    <select id="userID" name="userID">
                    </select>
                </div>
                <div class="form-group">
                    <label for="date">View Date:</label>
                    <input type="date" id="date" name="date" value="2024-01-30">
                </div>
                <button type="button" onclick="loadData()">Load Data</button>
                <button type="button" onclick="copyData()">Copy Data</button>
            </div>

            <!-- 2행 -->
            <div class="section-container">
                <!-- 1열: 현재 식사 전체 상태 -->
                <div class="food-data">
                    <h3>List Of Foods Consumed</h3>
                    <div class="food-data-content">
                        <div class="time-categories">
                            <button type="button" onclick="setActive(this)" data-category="Breakfast">Breakfast</button>
                            <button type="button" onclick="setActive(this)" data-category="Morning snack">Morning snack</button>
                            <button type="button" onclick="setActive(this)" data-category="Lunch">Lunch</button>
                            <button type="button" onclick="setActive(this)" data-category="Afternoon Snack">Afternoon Snack</button>
                            <button type="button" onclick="setActive(this)" data-category="Dinner">Dinner</button>
                            <button type="button" onclick="setActive(this)" data-category="Midnight Snack">Midnight Snack</button>
                        </div>
                        <div class="food-items">
                            <table class="food-table">
                                <thead>
                                    <tr>
                                        <th>Food Code</th>
                                        <th>Food Name</th>
                                    </tr>
                                </thead>
                                <tbody data-category="Breakfast"></tbody>
                                <tbody data-category="Morning snack"></tbody>
                                <tbody data-category="Lunch"></tbody>
                                <tbody data-category="Afternoon Snack"></tbody>
                                <tbody data-category="Dinner"></tbody>
                                <tbody data-category="Midnight Snack"></tbody>
                            </table>
                        </div>
                    </div>
                    <button type="button">Add Food</button>
                    <button type="button">Copy Food</button>
                    <button type="button">Delete Food</button>
                </div>
                <!-- 2열: 입력할 Food list 및 검색 -->
                <div class="food-search">
                    <h3>Food Intake Search</h3>
                    <div class="search-options">
                        <label>
                            <input type="radio" name="searchType" value="code" checked onclick="toggleInputFields()">
                            Food Code
                        </label>
                        <input type="text" id="codeInput">
                        <label>
                            <input type="radio" name="searchType" value="name" onclick="toggleInputFields()">
                            Food Name
                        </label>
                        <input type="text" id="nameInput" disabled>
                        <button type="button" onclick="searchFood()">Search</button>
                    </div>
                    <table id="foodTable" class="food-table">
                        <thead>
                            <tr>
                                <th>Food Code</th>
                                <th>Food Name</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- 검색 결과가 여기에 표시됩니다 -->
                        </tbody>
                    </table>
                    <div class="pagination">
                        <button type="button">«</button>
                        <button type="button">‹</button>
                        <span>Page 1 of 0</span>
                        <button type="button">›</button>
                        <button type="button">»</button>
                        <select>
                            <option value="30">30</option>
                            <option value="50">50</option>
                            <option value="100">100</option>
                        </select>
                    </div>
                    <button type="button" onclick="addToFoodList()">Add To Food List</button>
                </div>
                <!-- 3열: 식사에 대한 정보 -->
                <div class="food-details">
                    <h3>List Of Food Ingredients By Food Intake</h3>
                    <div class="form-group">
                        <label for="foodIntake">Food Intake Rate(%):</label>
                        <input type="text" id="foodIntake" name="foodIntake" value="100">
                    </div>
                    <table class="food-table">
                        <thead>
                            <tr>
                                <th>Ingrdient Code</th>
                                <th>Ingrdient</th>
                                <th>1 person (g)</th>
                            </tr>
                        </thead>
                        <tbody id="ingredientTableBody">
                            <!-- Ingredients will be dynamically added here -->
                        </tbody>
                    </table>
                    <button type="button">Apply</button>
                    <button type="button">Add Food Ingredient</button>
                    <button type="button">Delete Food Ingredient</button>
                </div>
            </div>

            <!-- 3행 : 테이블 -->
            <div class="nutrition-table-container">
                <h3>Nutritional Information of Consumed Food</h3>
                <div style="overflow-x: auto;">
                    <table class="nutrition-table">
                        <thead>
                            <tr>
                                <th>Type</th>
                                <th>ENERC (kcal)</th>
                                <th>WATER (g)</th>
                                <th>PROTCNT (g)</th>
                                <th>FAT (g)</th>
                                <th>CHOAVLDF (g)</th>
                                <th>FIBTG (g)</th>
                                <th>CA (mg)</th>
                                <th>FE (mg)</th>
                                <th>ZN (mg)</th>
                                <th>VITA_RAE (mcg)</th>
                                <th>VITD (mcg)</th>
                                <th>THIA (mg)</th>
                                <th>RIBF (mg)</th>
                                <th>NIA (mg)</th>
                                <th>PANTAC (mg)</th>
                                <th>VITB6 (mg)</th>
                                <th>FOL (mcg)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Current Food</td>
                                <td id="current-food-enerckcal"></td>
                                <td id="current-food-waterg"></td>
                                <td id="current-food-protcntg"></td>
                                <td id="current-food-fatg"></td>
                                <td id="current-food-choavldfg"></td>
                                <td id="current-food-fibtgg"></td>
                                <td id="current-food-camg"></td>
                                <td id="current-food-femg"></td>
                                <td id="current-food-znmg"></td>
                                <td id="current-food-vitaraemcg"></td>
                                <td id="current-food-vitdmcg"></td>
                                <td id="current-food-thiamg"></td>
                                <td id="current-food-ribfmg"></td>
                                <td id="current-food-niamg"></td>
                                <td id="current-food-pantacmg"></td>
                                <td id="current-food-vitb6mg"></td>
                                <td id="current-food-folmcg"></td>
                            </tr>
                            <tr>
                                <td>Current Meal</td>
                                <td id="current-meal-enerckcal"></td>
                                <td id="current-meal-waterg"></td>
                                <td id="current-meal-protcntg"></td>
                                <td id="current-meal-fatg"></td>
                                <td id="current-meal-choavldfg"></td>
                                <td id="current-meal-fibtgg"></td>
                                <td id="current-meal-camg"></td>
                                <td id="current-meal-femg"></td>
                                <td id="current-meal-znmg"></td>
                                <td id="current-meal-vitaraemcg"></td>
                                <td id="current-meal-vitdmcg"></td>
                                <td id="current-meal-thiamg"></td>
                                <td id="current-meal-ribfmg"></td>
                                <td id="current-meal-niamg"></td>
                                <td id="current-meal-pantacmg"></td>
                                <td id="current-meal-vitb6mg"></td>
                                <td id="current-meal-folmcg"></td>
                            </tr>
                            <tr>
                                <td>Daily Total</td>
                                <td id="daily-total-enerckcal"></td>
                                <td id="daily-total-waterg"></td>
                                <td id="daily-total-protcntg"></td>
                                <td id="daily-total-fatg"></td>
                                <td id="daily-total-choavldfg"></td>
                                <td id="daily-total-fibtgg"></td>
                                <td id="daily-total-camg"></td>
                                <td id="daily-total-femg"></td>
                                <td id="daily-total-znmg"></td>
                                <td id="daily-total-vitaraemcg"></td>
                                <td id="daily-total-vitdmcg"></td>
                                <td id="daily-total-thiamg"></td>
                                <td id="daily-total-ribfmg"></td>
                                <td id="daily-total-niamg"></td>
                                <td id="daily-total-pantacmg"></td>
                                <td id="daily-total-vitb6mg"></td>
                                <td id="daily-total-folmcg"></td>
                            </tr>
                        </tbody>
                    </table>                    
                </div>
                <div class="nutrition-controls">
                    <label for="nutrition-group">Select Nutrition Group:</label>
                    <select id="nutrition-group" name="nutrition-group">
                        <option value="basic">Basic Nutrition</option>
                        <!-- Add more options as needed -->
                    </select>
                    <button type="button" onclick="exportExcel()">Export to Excel</button>
                    <button type="button" onclick="showCurrentFood()">Current Food Nutrition</button>
                    <button type="button" onclick="showTotalNutrition()">Total Daily Nutrition</button>
                    <button type="button" onclick="generateChart()">Generate Chart</button>
                </div>
            </div>
            <div class="24h-result-container">
                <h3>24-Hour Recall Method Results</h3>
                <div class="tab">
                    <!-- <button class="tablinks" onclick="openTab(event, 'NutrientIntake')">Nutrient Intake</button> -->
                    <button class="tablinks" onclick="openTab(event, 'FoodGroupIntake')">Food Group Intake</button>
                </div>
                
                <!-- <div id="NutrientIntake" class="tabcontent">
                    <h3>Nutrient Intake</h3>
                    <img src="{{ url_for('static', filename='image.png') }}" alt="Nutrient Intake Graph">
                </div> -->

                <div id="FoodGroupIntake" class="tabcontent">
                    <form id="chartForm" action="/runchart" method="post">
                        <input type="hidden" id="currentMealEnerckcal" name="currentMealEnerckcal">
                        <input type="hidden" id="currentMealEnerckj" name="currentMealEnerckj">
                        <input type="hidden" id="currentMealWaterg" name="currentMealWaterg">
                        <input type="hidden" id="currentMealProtcntg" name="currentMealProtcntg">
                        <input type="hidden" id="currentMealFatg" name="currentMealFatg">
                        <input type="hidden" id="currentMealChoavldfg" name="currentMealChoavldfg">
                        <input type="hidden" id="currentMealFibtgg" name="currentMealFibtgg">
                        <input type="hidden" id="currentMealAshg" name="currentMealAshg">
                        <input type="hidden" id="currentMealCamg" name="currentMealCamg">
                        <input type="hidden" id="currentMealFemg" name="currentMealFemg">
                        <input type="hidden" id="currentMealZnmg" name="currentMealZnmg">
                        <input type="hidden" id="currentMealVitaraemcg" name="currentMealVitaraemcg">
                        <input type="hidden" id="currentMealVitdmcg" name="currentMealVitdmcg">
                        <input type="hidden" id="currentMealThiamg" name="currentMealThiamg">
                        <input type="hidden" id="currentMealRibfmg" name="currentMealRibfmg">
                        <input type="hidden" id="currentMealNiamg" name="currentMealNiamg">
                        <input type="hidden" id="currentMealPantacmg" name="currentMealPantacmg">
                        <input type="hidden" id="currentMealVitb6mg" name="currentMealVitb6mg">
                        <input type="hidden" id="currentMealFolmcg" name="currentMealFolmcg">
                        <button type="button" onclick="submitChartForm()">Show Food Intake Status Chart</button>
                    </form>
                </div>

        </div>
    </div>
    <script src="{{ url_for('static', filename='24h.js') }}"></script>
    <script>
        function openTab(evt, tabName) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tablinks");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";
        }

        // Open the first tab by default
        document.getElementsByClassName("tablinks")[0].click();
    </script>
</body>
</html>


{% endblock %}
